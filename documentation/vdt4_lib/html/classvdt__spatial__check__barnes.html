<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3"/>
<title>vdt: vdt_spatial_check_barnes Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">vdt
   &#160;<span id="projectnumber">4.0</span>
   </div>
   <div id="projectbrief">vdt4.0</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classvdt__spatial__check__barnes-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">vdt_spatial_check_barnes Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="vdt__spatial__check_8hh_source.html">vdt_spatial_check.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6b2c37e91cc372968d982c84c4e405e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvdt__spatial__check__barnes.html#a6b2c37e91cc372968d982c84c4e405e7">vdt_spatial_check_barnes</a> (size_t barnes_min_size_arg, size_t barnes_sd_max_arg)</td></tr>
<tr class="memdesc:a6b2c37e91cc372968d982c84c4e405e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">barnes constructor  <a href="#a6b2c37e91cc372968d982c84c4e405e7"></a><br/></td></tr>
<tr class="separator:a6b2c37e91cc372968d982c84c4e405e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab149f3b367d85c1cc37f18885372ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvdt__spatial__check__barnes.html#a8ab149f3b367d85c1cc37f18885372ec">perform_barnes</a> (vector&lt; float &gt; &amp;values, vector&lt; float &gt; &amp;distances, float target_reading)</td></tr>
<tr class="memdesc:a8ab149f3b367d85c1cc37f18885372ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">perform_barnes perform barnes spatial check  <a href="#a8ab149f3b367d85c1cc37f18885372ec"></a><br/></td></tr>
<tr class="separator:a8ab149f3b367d85c1cc37f18885372ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a314f618ba2c18c4982fb695befb140f8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvdt__spatial__check__barnes.html#a314f618ba2c18c4982fb695befb140f8">calc_distances</a> (const <a class="el" href="classvdt__point.html">vdt_point</a> &amp;target, const vector&lt; <a class="el" href="classvdt__point.html">vdt_point</a> &gt; &amp;near, vector&lt; float &gt; &amp;distances)</td></tr>
<tr class="memdesc:a314f618ba2c18c4982fb695befb140f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate distances from target point to vector of points  <a href="#a314f618ba2c18c4982fb695befb140f8"></a><br/></td></tr>
<tr class="separator:a314f618ba2c18c4982fb695befb140f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Like the IQR test, the neighboring stations used for spatial comparison are determined by a formula based on configurable tolerance bounds. Unlike the IQR test, neighboring sensor readings are weighted according to their distance from the original sensor, with the weight decreasing exponentially with the distance from the station. In the Clarus System, neighboring values (Zi) are based on ASOS, AWOS, and ESS in situ data. The ASOS program is a joint effort of the National Weather Service (NWS), the Federal Aviation Administration (FAA), and the Department of Defense (DOD). The ASOS systems serve as the nation's primary surface weather observing network. ASOS is designed to support weather forecast activities and aviation operations and, at the same time, support the needs of the meteorological, hydrological, and climatological research communities. The AWOS provides basic aviation weather observations directly to pilots approaching the airport. The majority of the ~170 systems were installed at various non-towered airports (OFCM, 2009). The neighboring stations used for spatial comparison must fall within a distance set by a configuration parameter. Neighboring observations are weighted according to their distance from the original sensor, with the weight decreasing exponentially with the distance from the station.</p>
<p>Each time this test is invoked, it is given a single observation. Through the observation instance, it obtains a sensor and a station. If the sensor or station cannot be obtained, the test returns immediately with an error condition indicating that it was unable to run. Then a set of observations to use for the spatial analysis is determined. If there are fewer than two observations of the same type available or if the IQR Spatial Test was able to run, the test returns immediately with an error condition indicating that it was unable to run. A target observation does not pass the Barnes Spatial Test when the target observation value (Z0) falls outside of the range defined by the number of configured standard deviations about the weighted mean of the neighboring observations (Ze). An observation does not pass the Barnes Spatial Test when:</p>
<p>|Ze - Zo| &gt; SdMax * sigma where Zo = Target observation Ze = Weighted mean of neighboring observations Zi = The ith neighboring observation SdMax = The configured allowable standard deviations sigma = Estimated standard deviation and where the weighted mean is computed as follows: Ze = (SUM(W(ri) * Zi)/(SUM(W(ri))</p>
<p>where W(ri) = exp( -|Zi - Z0|**2 / (2*(ri/sigma)**2))</p>
<p>The Barnes spatial test only runs when the IQR test does not run and if there are 2 or more ASOS, AWOS and/or ESS neighbors that satisfy all of the following conditions:</p>
<p>. Within the configured radius of the target observation, typically 69 miles . Within 65 minutes of the target observation time, -60 minutes to +5 minutes to accommodate potential skewed time reporting</p>
<p>Otherwise, the test will not run. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a6b2c37e91cc372968d982c84c4e405e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vdt_spatial_check_barnes::vdt_spatial_check_barnes </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>barnes_min_size_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>barnes_sd_max_arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>barnes constructor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">barnes_min_size_arg</td><td>minimum number of values to use for performing BARNES spatial test </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">barnes_sd_max_arg</td><td>maximum allowable number of standard deviations from weighted mean to pass test </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a314f618ba2c18c4982fb695befb140f8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void vdt_spatial_check_barnes::calc_distances </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classvdt__point.html">vdt_point</a> &amp;&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; <a class="el" href="classvdt__point.html">vdt_point</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>near</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>distances</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculate distances from target point to vector of points </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">target</td><td>target point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">near</td><td>nearby station observation location points </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">distances</td><td>distances from target to nearby stations </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8ab149f3b367d85c1cc37f18885372ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vdt_spatial_check_barnes::perform_barnes </td>
          <td>(</td>
          <td class="paramtype">vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>distances</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>target_reading</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>perform_barnes perform barnes spatial check </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">values</td><td>nearby station observation values </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">distances</td><td>distances to nearby stations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">target_reading</td><td>target reading of sensor to compare against nearby station observation values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vdt_probe_message_qc::NOT_APPLICABLE - test cannot be performed, vdt_probe_message_qc::FAILED - test was performed and failed, 1 - vdt_probe_message_qc::PASSED </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="vdt__spatial__check_8hh_source.html">vdt_spatial_check.hh</a></li>
<li><a class="el" href="vdt__spatial__check_8cc.html">vdt_spatial_check.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 10 2014 18:46:32 for vdt by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3
</small></address>
</body>
</html>
